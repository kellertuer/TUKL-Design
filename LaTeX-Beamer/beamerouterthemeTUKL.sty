%
% Alternate Outer Theme based on an idea by the Intitute of Telematics
%
% Declaration of Options, definition of specific commands the the design elements,
% such as headline, footline and frametitle
%
% Published under Beeware-License:
%
% THE BEER-WARE LICENSE (Rev. 42):
% Ronny Bergmann <bergmann@mathematik.uni-kl.de> wrote this file. As long as
% you retain this notice you can do whatever you want with this stuff. If we
% meet some day, and you think this stuff is worth it, you can buy me a beer
% or coffee in return.
%
\ProvidesPackage{beamerouterthemeTUKL}[2015/02/05 v0.92 beamer theme in the corporate design of the University of Kaiserslautern]
\makeatletter
%
\newlength{\footlineheight}
\setlength{\footlineheight}{0.02\paperheight}
\defbeamertemplate*{footline}{TUKL}
{%
	\leavevmode%
	\centering
	\hbox{%
	\begin{beamercolorbox}[colsep=0.25pt,sep=0pt,dp=0pt]{upper separation line foot}
   \end{beamercolorbox}
	}
	\hbox{
	\begin{beamercolorbox}[wd=.333333\paperwidth,ht=\footlineheight,dp=0.4\footlineheight,left]{palette tertiary}%
		\hspace{2em}%
		\usebeamerfont{author in head/foot}\insertshortauthor%
		\end{beamercolorbox}\hspace{-1pt}%Hacked up to now
%
		\begin{beamercolorbox}[wd=.4\paperwidth,ht=\footlineheight,dp=0.4\footlineheight,center]{palette tertiary}%
			\usebeamerfont{title in head/foot}\insertshorttitle
		\end{beamercolorbox}\hspace{-1pt}%Hacked up to now
%
		\begin{beamercolorbox}[wd=.3\paperwidth,ht=\footlineheight,dp=0.4\footlineheight,right]{palette tertiary}%
			\usebeamerfont{date in head/foot}\insertshortdate{}\hspace*{2em}
		\iftukl@reduceTotalFrameNumber%fancy&still useless reduction ;)
		\pgfmathtruncatemacro{\numerator}{%
	\insertframenumber/gcd(\insertframenumber,\inserttotalframenumber)}%
		\pgfmathtruncatemacro{\denominator}{%
	\inserttotalframenumber/gcd(\insertframenumber,\inserttotalframenumber)}%
					\ifnum\denominator=1%
						\numerator%
					\else%
						\numerator/\denominator%
					\fi%
				\else%
					\insertframenumber{}%
					\iftukl@displayTotalFrameNumber%
						/ \inserttotalframenumber%
					\fi%
				\fi%
 			\hspace*{6ex}%
 		\end{beamercolorbox}
 	}%
}
 
\defbeamertemplate*{headline}{TUKL} 
{ 
	\leavevmode
	\centering
	\vspace*{2ex}
	\hspace*{-2ex}
	\hbox{
	\iffbset
	%
	% Left: Fachbereichs-Box, middle: Navigation, right: Logo
	% 
	\begin{beamercolorbox}%
			[wd=.245\paperwidth, ht=.033784928\paperwidth, center, sep=4pt, dp=1ex, rounded=true]{fachbereich in head/foot}
			\hfill\vspace*{-.6ex}%Manual Hack to vert center
			\hspace*{2ex}{\normalsize\expandafter\uppercase\expandafter{\theDept}}
			\hfill
		\end{beamercolorbox}
		\hspace*{1ex}
	 	\begin{beamercolorbox}[leftskip=0ex,rightskip=0pt,wd=.51\paperwidth, ht=.033784928\paperwidth,vmode,left,sep=0pt]{palette secondary}
			\vfill%Hack
			\iftukl@displayNavigation%
				\ifnum\c@framenumber=1%
					\relax%
				\else%
	 				\insertnavigation{.5\paperwidth}%
				\fi%
			\fi%
			\vfill
		\end{beamercolorbox}
		\begin{beamercolorbox}%
				[wd=.245\paperwidth, ht=.033784928\paperwidth, center, sep=0pt, dp=1ex, rounded=true]{logo in head/foot}
				\hfill\vfill{}
				\hspace*{-1.5ex}\includegraphics[width=.175\paperwidth]{logos/TUKL_LOGO_RGB.png}
				\hfill\vfill{}
			\end{beamercolorbox}
	\else
	% Left: Logo
	% middle & right: Navigation if active
		\begin{beamercolorbox}%
			[wd=.245\paperwidth, ht=.033784928\paperwidth, center, sep=0pt, dp=1ex, rounded=true]{logo in head/foot}
			\hfill\vfill{}
			\hspace*{2ex}\includegraphics[width=.175\paperwidth]{logos/TUKL_LOGO_RGB.png}
			\hfill\vfill{}
		\end{beamercolorbox}
		\hspace*{1ex}
	 	\begin{beamercolorbox}[leftskip=0pt,rightskip=0pt,wd=.755\paperwidth, ht=.033784928\paperwidth,vmode,left,sep=0pt]{palette secondary}
			\vfill
			\iftukl@displayNavigation%
				\ifnum\c@framenumber=1%
				\relax
				\else%
	 				\insertnavigation{.745\paperwidth}%
				\fi%
				\vfill
	 		\fi
	 	\end{beamercolorbox}
	\fi
	} %end of hbox
	\strut
	\par
	\vskip.125\baselineskip
	\hspace{.02\paperwidth}
} 
%
% Plain Style for the titlepage
%
\defbeamertemplate{footline}{TUKLplain}{}
\defbeamertemplate{headline}{TUKLplain} 
{ 
	\leavevmode%
	\vspace{.25\baselineskip}
	\strut
	\par
}
%
% Title page stuff
%
\defbeamertemplate*{frametitle}{TUKL}
{
	\nointerlineskip%
	\begin{beamercolorbox}[wd=\paperwidth,leftskip=.3cm,rightskip=.3cm plus1fil,vmode]{frametitle}
		\par{\usebeamerfont*{frametitle}\insertframetitle\strut\par}%
		\ifx\insertframesubtitle\@empty%
			\strut\par%
			\vspace{-2\baselineskip}
		\else
			\vskip-.25ex%
		\par{\usebeamerfont*{framesubtitle}{\usebeamercolor[fg]{framesubtitle}\insertframesubtitle}\strut\par}%
			\vskip-.5ex%
		\fi%
		\vskip.5ex%
	\end{beamercolorbox}%
	\nointerlineskip%
}
\setbeamersize{text margin left=2em,text margin right=2em}
 
\renewcommand{\maketitle}[0]
{%
 	\setbeamertemplate{headline}[TUKL]%
 	\setbeamertemplate{footline}[TUKLplain]%
 	\ifbeamer@inframe%
 		\vspace{1.3ex}%
 		\titlepage%
 	\else%
 		\frame[t]{\titlepage}%
 	\fi%
   	\setbeamertemplate{headline}[TUKL]%
 	\setbeamertemplate{footline}[TUKL]%
}
\mode<all> 
\makeatother